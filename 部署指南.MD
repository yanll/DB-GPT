## 部署指南



#### 环境准备
* 创建Python虚拟环境：XXX
* 切换至虚拟环境
* 安装依赖：pip install -e ".[default]"
* 加速方式：pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -e ".[default]"


#### 依赖组件安装
* pip install langchain_openai
* pip install langgraph:0.0.47+
* pip install redis
* pip install pycryptodome
* pip install requests_toolbelt


#### 选填
* pip install langchainhub
* pip install tavily-python
* pip install grandalf
* pip install pygraphviz
[//]: # (https://smith.langchain.com/)
[//]: # (https://app.tavily.com/home)


#### 资源配置
* 拷贝text2vec-large-chinese模型至项目：./YP-GPT/models/text2vec-large-chinese
* 将.env.local中的配置覆盖到.env
* 启动项目：python dbgpt/app/dbgpt_server.py --port 5670
* vs code debug: python -m debugpy --listen 5678 dbgpt/app/dbgpt_server.py --port 5670

#### 启动端口
* ngrok http 5670


#### 重要：关于项目配置文件的说明
.env文件中的以下配置需要改为本地
* LOCAL_DB_TYPE=mysql
* LOCAL_DB_USER=dp_agggw
* LOCAL_DB_PASSWORD=dp_agggwABC123!
* LOCAL_DB_HOST=10.171.0.139
* LOCAL_DB_PORT=3316
* LOCAL_DB_NAME=dp_agggw
* 
* ENV_CONFIG_FILE=/Users/ideamac/env/workspaces/pyprojects/config.env

其中ENV_CONFIG_FILE对应的文件不放到代码仓库，单独提供。

#### 线上发版流程
* 1、进堡垒机
* 2、conda activate dbgpt_env
* 3、进入YP-GPT
* 4、git pull
* 5、./startup.sh



#### unit test

pytest -s ./tests/intetration_tests/datasource/test_conn_clickhouse.py